<?php

/**
 * ---------------------------------------------------------------------------------------------------------------------
 * Integrated by BKLV-Robo [RBOX-3]
 * Version: 3.0.2
 * Sysmtem URL: http://bklv.ru/robo/
 * User: webmaster.rentabox@bklv.ru
 * Date: 23.05.2017
 * Time: 13:02
 * Tech support:
 *  - url: http://bklv.ru/tech_support/
 *  - email: rbox.support.tech@bklv.ru
 *  - phone: +7(495)220-17-27
 * ---------------------------------------------------------------------------------------------------------------------
 */

#=======================================================================================================================
$path = $_SERVER['DOCUMENT_ROOT'] . '/.bklv';
/** @noinspection PhpIncludeInspection */
include($path);
#=======================================================================================================================

/** Class SYSTEM-App */
class App extends AppFunc
{

    #===================================================================================================================
    /** Initializes new App */
    function __construct()
    {
        #---------------------------------------------------------------------------------------------------------------
        /** 1. Usual start of the App [Старт приложения в нормальном режиме] */
        $this->start(__METHOD__);
        #---------------------------------------------------------------------------------------------------------------
        /** 2. Use site lockers by IP, COOKIE, etc [Использовать внешние ограничители по IP, cookie и т.д.] */
        $this->siteLockers($this->d['modules']['siteLockers']);
        #---------------------------------------------------------------------------------------------------------------
        /** 3. Load init environment parameters [Загрузка начальных параметров окружения] */
        $this->loadInitEnvParams();
        #---------------------------------------------------------------------------------------------------------------
        /** 4. Setup Special Params [Установка специальных параметров модулей] */
        $this->updateEnvParams();
        #---------------------------------------------------------------------------------------------------------------
        /** 5. Get route params [применяем роутинга] */
        $this->getRoutingAndEventParams();
        #---------------------------------------------------------------------------------------------------------------
        /** 6. Set event options */
        $this->setEventOptions();
        #---------------------------------------------------------------------------------------------------------------
        /** 7. Setup app exec Params [Уточняем параметры работы приложения] */
        $this->setupExecutionParams();
        #---------------------------------------------------------------------------------------------------------------
        /** 8. Setup trace and debug screens [Уточняем итоговые параметры трейсинга и дебаггинга] */
        $this->setupScreenParams();
        #---------------------------------------------------------------------------------------------------------------
        /** 9. Activate route handler and event [вызываем метод обработчика через роутинг] */
        $h2 = $this->eventDefault['handler'];
        $m2 = $this->eventDefault['method'];
        $this->useRemoteAction($this->eventHandler, $this->eventMethod, array(), $h2, $m2);
        #---------------------------------------------------------------------------------------------------------------
        /** 10. Final */
        $this->finals(__METHOD__);
        #---------------------------------------------------------------------------------------------------------------
    }
    #===================================================================================================================


}